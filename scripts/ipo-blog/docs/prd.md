# 공모주 (IPO) 조사 내용 작성 자동화

## 목적

국내 공모주 IPO 에 대해서 조사한 내용을 블로그 포스팅 형식으로 자동으로 작성한다. 

## 요구사항

### 1. 블로그 포스팅이 생성되는 기준

- [IPO 목록](https://finance.naver.com/sise/ipo.naver)에서 아래 증권사에 대해서만 생성한다
  - 미래에셋
  - 한국투자
  - 신한투자
  - KB
  - NH
  - 삼성
- 최소한으로 아래 정보가 있어야 생성한다
  - 공모금액
  - 기관경쟁률

### 2. 블로그에 내용 작성하기

- 블로그 내용은 아래 목차를 참고해서 작성한다 

## 구현 지침

### 1. 포스팅 생성 조건

- 스크립트를 여러 번 실행해도 중복으로 생성을 하지 않는다
  - 생성한 IPO 블로그에 대해서는 MySQL DB에 저장을 해서 확인한다
  - 중복 체크는 종목코드를 기준으로 한다

### 2. 데이터베이스 설계

- MySQL을 사용하며, 접속 정보는 환경변수로 제공된다
- 크롤링한 데이터와 생성된 포스팅 정보를 저장한다
- DB 스키마는 구현시 별도로 설계한다

### 3. IPO 포스팅 내용 목차

### 3.1 작성시 주의사항

- 블로그 작성할 내용은 ChatGPT API를 사용해서 작성을 한다
  - 여러 사이트에서 데이터 수집이 완료되면 목차 기준에 맞게 블로그 생성을 위해 ChatGPT API를 1회 호출한다

- 작성시 필요한 정보는 아래 링크를 참고한다
    - https://finance.naver.com/sise/ipo.naver
    - https://www.38.co.kr/html/fund/index.htm?o=r
      - 38 커뮤니케이션 사이트에서 IPO 정보를 검색하려면 기업검색 란에서 기업을 검색하고 검색된 목록에서 회사를 클릭해 들어가야 해당 기업에 대한 정보를 알 수 있다

### 3.2 목차

- 기업에 대한 조사
  - 어떤 회사인가? 뭘로 돈을 버는가? 
  - 비슷한 사업을 하는 경쟁사는 뭐가 있나
  - 기업에 대한 뉴스
    - 구글, 네이버에서 최대 4개의 뉴스를 수집한다
    - 각 뉴스에 대해서 3~5줄 정도로 요약해주고 매매에 대한 긍정/부정 적인 내용인지도 알려줘
    - 긍정/부정 판단은 ChatGPT를 사용한다
- 공모주 기본 정보
  - 아래 정보들은 테이블 형식으로 작성한다
  - 기업 개요
    - 종목명: ex. 위너스
    - 종목코드
    - 시장구분: ex. 코스닥
    - 기업구분: ex. 중소일반
    - 업종
    - 주요제품 
    - 홈페이지
    - 최대주주
    - 매출액
    - 순이익
    - 자본금
  - 공모 정보
    - 희망공모가
    - 확정 공모가
    - 청약증권사
    - 수요예측결과
      - 통합경재률
      - 기관경쟁률
    - 배정주식수
      - 일반청약자
      - 기관투자자
  - 청약 일정
    - 주요일정
      - 수요예측일
      - 공모청약일
      - 납입일
      - 환불일
      - 상장일
- 기업 분석 내용
  - 재무현황
    - 아래 내용은 참고할 수 있는 사이트에서 데이터를 수집해서 그래프로 그려준다
      - 매출액, 영업이익, 당기순이익
    - 재무 데이터가 부족한 경우에는 그래프 대신 테이블 형태로만 작성한다
  - 부채 관련 데이터도 수집해서 그래프로 그려준다

### 4. 스크립트 작성

- 스크립트는 python으로 작성한다
  - 웹 사이트에서 데이터를 추출해야 해서 BeautifulSoup library를 사용한다
  - 여러 번 스크래핑시 차단되지 않도록 다음 사항을 준수한다:
    - User-Agent 설정
    - Request 간 적절한 간격 유지
    - robots.txt 준수
  
- 결과는 Markdown 형식의 파일을 생성한다
  - 파일 경로: `output/종목코드-종목명/index.md`
  
- 그래프는 plotly library를 사용해서 생성한다
  - 이미지 저장 경로는 markdown 파일과 같은 위치에 저장한다

- 블로그 생성이나 기업에 대한 조사는 ChatGPT API를 사용한다
  - 필요한 API 키는 환경 변수를 사용한다

### 5. 데이터 불완전성 처리

- 공개되지 않은 정보의 경우:
  - 다른 값이 있으면 그 값을 사용한다
  - 없으면 "Unknown"으로 명시한다
- 일부 정보만 있을 때에도 포스팅을 생성한다

### 6. 실행 방식

- 수동으로 스크립트를 실행한다
  